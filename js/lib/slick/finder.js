"use strict";var parse=require("./parser"),index=0,counter=document.__counter=(parseInt(document.__counter||-1,36)+1).toString(36),key="uid:"+counter,uniqueID=function(t,e){if(t===window)return"window";if(t===document)return"document";if(t===document.documentElement)return"html";if(e){var n=t.getAttribute(key);return n||(n=(index++).toString(36),t.setAttribute(key,n)),n}return t[key]||(t[key]=(index++).toString(36))},uniqueIDXML=function(t){return uniqueID(t,!0)},isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},uniqueIndex=0,HAS={GET_ELEMENT_BY_ID:function(t,e){return e="slick_"+uniqueIndex++,t.innerHTML='<a id="'+e+'"></a>',!!this.getElementById(e)},QUERY_SELECTOR:function(t){return t.innerHTML="_<style>:nth-child(2){}</style>",t.innerHTML='<a class="MiX"></a>',1===t.querySelectorAll(".MiX").length},EXPANDOS:function(t,e){return e="slick_"+uniqueIndex++,t._custom_property_=e,t._custom_property_===e},MATCHES_SELECTOR:function(e){e.className="MiX";var n=e.matchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector;if(n)try{n.call(e,":slick")}catch(t){return!!n.call(e,".MiX")&&n}return!1},GET_ELEMENTS_BY_CLASS_NAME:function(t){return t.innerHTML='<a class="f"></a><a class="b"></a>',1===t.getElementsByClassName("b").length&&(t.firstChild.className="b",2===t.getElementsByClassName("b").length&&(t.innerHTML='<a class="a"></a><a class="f b a"></a>',2===t.getElementsByClassName("a").length))},GET_ATTRIBUTE:function(t){var e="fus ro dah";return t.innerHTML='<a class="'+e+'"></a>',t.firstChild.getAttribute("class")===e}},Finder=function(t){this.document=t;var e=this.root=t.documentElement;this.tested={},this.uniqueID=this.has("EXPANDOS")?uniqueID:uniqueIDXML,this.getAttribute=this.has("GET_ATTRIBUTE")?function(t,e){return t.getAttribute(e)}:function(t,e){return(t=t.getAttributeNode(e))&&t.specified?t.value:null},this.hasAttribute=e.hasAttribute?function(t,e){return t.hasAttribute(e)}:function(t,e){return!(!(t=t.getAttributeNode(e))||!t.specified)},this.contains=t.contains&&e.contains?function(t,e){return t.contains(e)}:e.compareDocumentPosition?function(t,e){return t===e||!!(16&t.compareDocumentPosition(e))}:function(t,e){do{if(e===t)return!0}while(e=e.parentNode);return!1},this.sorter=e.compareDocumentPosition?function(t,e){return t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:t===e?0:1:0}:"sourceIndex"in e?function(t,e){return t.sourceIndex&&e.sourceIndex?t.sourceIndex-e.sourceIndex:0}:t.createRange?function(t,e){if(!t.ownerDocument||!e.ownerDocument)return 0;var n=t.ownerDocument.createRange(),r=e.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,0),r.setStart(e,0),r.setEnd(e,0),n.compareBoundaryPoints(Range.START_TO_END,r)}:null,this.failed={};var n=this.has("MATCHES_SELECTOR");n&&(this.matchesSelector=function(t,e){if(this.failed[e])return null;try{return n.call(t,e)}catch(t){return slick.debug&&console.warn("matchesSelector failed on "+e),this.failed[e]=!0,null}}),this.has("QUERY_SELECTOR")&&(this.querySelectorAll=function(t,e){if(this.failed[e])return!0;var n,r,i,s,o;if(t!==this.document&&(s=e[0].combinator,i=e,(r=t.getAttribute("id"))||(r="__slick__",(o=t).setAttribute("id",r)),e="#"+r+" "+i,(-1<s.indexOf("~")||-1<s.indexOf("+"))&&((t=t.parentNode)||(n=!0))),!n)try{n=t.querySelectorAll(e.toString())}catch(t){slick.debug&&console.warn("querySelectorAll failed on "+(i||e)),n=this.failed[i||e]=!0}return o&&o.removeAttribute("id"),n})};Finder.prototype.has=function(t){var e=this.tested,n=e[t];if(null!=n)return n;var r=this.root,i=this.document,s=i.createElement("div");s.setAttribute("style","display: none;"),r.appendChild(s);var o=HAS[t],u=!1;if(o)try{u=o.call(i,s)}catch(t){}return slick.debug&&!u&&console.warn("document has no "+t),r.removeChild(s),e[t]=u};var combinators={" ":function(t,e,n){var r,i,s=!e.id,o=!e.tag,u=!e.classes;if(e.id&&t.getElementById&&this.has("GET_ELEMENT_BY_ID")&&(r=t.getElementById(e.id))&&r.getAttribute("id")===e.id&&(i=[r],s=!0,"*"===e.tag&&(o=!0)),!i&&(e.classes&&t.getElementsByClassName&&this.has("GET_ELEMENTS_BY_CLASS_NAME")?(i=t.getElementsByClassName(e.classList),u=!0,"*"===e.tag&&(o=!0)):(i=t.getElementsByTagName(e.tag),"*"!==e.tag&&(o=!0)),!i||!i.length))return!1;for(var c=0;r=i[c++];)(o&&s&&u&&!e.attributes&&!e.pseudos||this.match(r,e,o,s,u))&&n(r);return!0},">":function(t,e,n){if(t=t.firstChild)for(;1==t.nodeType&&this.match(t,e)&&n(t),t=t.nextSibling;);},"+":function(t,e,n){for(;t=t.nextSibling;)if(1==t.nodeType){this.match(t,e)&&n(t);break}},"^":function(t,e,n){(t=t.firstChild)&&(1===t.nodeType?this.match(t,e)&&n(t):combinators["+"].call(this,t,e,n))},"~":function(t,e,n){for(;t=t.nextSibling;)1===t.nodeType&&this.match(t,e)&&n(t)},"++":function(t,e,n){combinators["+"].call(this,t,e,n),combinators["!+"].call(this,t,e,n)},"~~":function(t,e,n){combinators["~"].call(this,t,e,n),combinators["!~"].call(this,t,e,n)},"!":function(t,e,n){for(;t=t.parentNode;)t!==this.document&&this.match(t,e)&&n(t)},"!>":function(t,e,n){(t=t.parentNode)!==this.document&&this.match(t,e)&&n(t)},"!+":function(t,e,n){for(;t=t.previousSibling;)if(1==t.nodeType){this.match(t,e)&&n(t);break}},"!^":function(t,e,n){(t=t.lastChild)&&(1==t.nodeType?this.match(t,e)&&n(t):combinators["!+"].call(this,t,e,n))},"!~":function(t,e,n){for(;t=t.previousSibling;)1===t.nodeType&&this.match(t,e)&&n(t)}};Finder.prototype.search=function(t,e,n){t?!t.nodeType&&t.document&&(t=t.document):t=this.document;var r=parse(e);if(!r||!r.length)throw new Error("invalid expression");n||(n=[]);var i,s,o,u,c=isArray(n)?function(t){n[n.length]=t}:function(t){n[n.length++]=t};if(1<r.length){i={};var a=c;c=function(t){var e=uniqueID(t);i[e]||(i[e]=!0,a(t))}}t:for(var l=0;e=r[l++];)if(slick.noQSA||!this.querySelectorAll||!0===(o=this.querySelectorAll(t,e)))if(1===e.length)u=e[0],combinators[u.combinator].call(this,t,u,c);else{var f,h,d,m=[t],g=function(t){var e=uniqueID(t);d[e]||(d[e]=!0,h[h.length]=t)};for(y=0;u=e[y++];){h=[],d={};for(var p=0;f=m[p++];)combinators[u.combinator].call(this,f,u,g);if(!h.length)continue t;m=h}if(0===l)n=h;else for(var b=0;b<h.length;b++)c(h[b])}else if(o&&o.length)for(var y=0;s=o[y++];)"@"<s.nodeName&&c(s);return i&&n&&1<n.length&&this.sort(n),n},Finder.prototype.sort=function(t){return this.sorter?Array.prototype.sort.call(t,this.sorter):t};var pseudos={empty:function(){return!(this&&1===this.nodeType||(this.innerText||this.textContent||"").length)},not:function(t){return!slick.matches(this,t)},contains:function(t){return-1<(this.innerText||this.textContent||"").indexOf(t)},"first-child":function(){for(var t=this;t=t.previousSibling;)if(1==t.nodeType)return!1;return!0},"last-child":function(){for(var t=this;t=t.nextSibling;)if(1==t.nodeType)return!1;return!0},"only-child":function(){for(var t=this;t=t.previousSibling;)if(1==t.nodeType)return!1;for(var e=this;e=e.nextSibling;)if(1==e.nodeType)return!1;return!0},"first-of-type":function(){for(var t=this,e=t.nodeName;t=t.previousSibling;)if(t.nodeName==e)return!1;return!0},"last-of-type":function(){for(var t=this,e=t.nodeName;t=t.nextSibling;)if(t.nodeName==e)return!1;return!0},"only-of-type":function(){for(var t=this,e=this.nodeName;t=t.previousSibling;)if(t.nodeName==e)return!1;for(var n=this;n=n.nextSibling;)if(n.nodeName==e)return!1;return!0},enabled:function(){return!this.disabled},disabled:function(){return this.disabled},checked:function(){return this.checked||this.selected},selected:function(){return this.selected},focus:function(){return this.ownerDocument.activeElement===this&&(this.href||this.type||slick.hasAttribute(this,"tabindex"))},root:function(){return this===this.ownerDocument.documentElement}};Finder.prototype.match=function(t,e,n,r,i){if(!slick.noQSA&&this.matchesSelector){var s=this.matchesSelector(t,e);if(null!==s)return s}if(!n&&e.tag){var o=t.nodeName.toLowerCase();if("*"===e.tag){if(o<"@")return!1}else if(o!=e.tag)return!1}if(!r&&e.id&&t.getAttribute("id")!==e.id)return!1;var u,c,a,l;if(!i&&e.classes){var f=this.getAttribute(t,"class");if(!f)return!1;for(c in e.classes)if(!RegExp("(^|\\s)"+e.classes[c]+"(\\s|$)").test(f))return!1}if(e.attributes)for(u=0;c=e.attributes[u++];){var h=c.operator,d=c.escapedValue;if(a=c.name,l=c.value,h){var m=this.getAttribute(t,a);if(null==m)return!1;switch(h){case"^=":if(!RegExp("^"+d).test(m))return!1;break;case"$=":if(!RegExp(d+"$").test(m))return!1;break;case"~=":if(!RegExp("(^|\\s)"+d+"(\\s|$)").test(m))return!1;break;case"|=":if(!RegExp("^"+d+"(-|$)").test(m))return!1;break;case"=":if(m!==l)return!1;break;case"*=":if(-1===m.indexOf(l))return!1;break;default:return!1}}else if(!this.hasAttribute(t,a))return!1}if(e.pseudos)for(u=0;c=e.pseudos[u++];){if(a=c.name,l=c.value,pseudos[a])return pseudos[a].call(t,l);if(null!=l){if(this.getAttribute(t,a)!==l)return!1}else if(!this.hasAttribute(t,a))return!1}return!0},Finder.prototype.matches=function(t,e){var n=parse(e);if(1===n.length&&1===n[0].length)return this.match(t,n[0][0]);if(!slick.noQSA&&this.matchesSelector){var r=this.matchesSelector(t,n);if(null!==r)return r}for(var i,s=this.search(this.document,e,{length:0}),o=0;i=s[o++];)if(t===i)return!0;return!1};var finders={},finder=function(t){var e=t||document;if(e.ownerDocument?e=e.ownerDocument:e.document&&(e=e.document),9!==e.nodeType)throw new TypeError("invalid document");var n=uniqueID(e);return finders[n]||(finders[n]=new Finder(e))},slick=function(t,e){return slick.search(t,e)};slick.search=function(t,e,n){return finder(e).search(e,t,n)},slick.find=function(t,e){return finder(e).search(e,t)[0]||null},slick.getAttribute=function(t,e){return finder(t).getAttribute(t,e)},slick.hasAttribute=function(t,e){return finder(t).hasAttribute(t,e)},slick.contains=function(t,e){return finder(t).contains(t,e)},slick.matches=function(t,e){return finder(t).matches(t,e)},slick.sort=function(t){return t&&1<t.length&&finder(t[0]).sort(t),t},slick.parse=parse,module.exports=slick;